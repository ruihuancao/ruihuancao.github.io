---
title: Android自动化构建
date: 2016-04-15 20:10:13
categories:
- Android
tags:
- Android
---
每次打包，发布都是固定流程，且存在人为干预风险，有可能会出错。之前有人搞错包，把debug版本发布出去了。就想着如何解决，使用程序自动打包发布。

<!--more-->

发布版本流程：
1 代码review，提交开发分支，打包测试
2 测试完成，合并主分支，新建版本tag及变化日志
3 运行程序打包发布

## V1 版本
一开始直接想到使用shell脚本来搞定。
脚本流程：
1 git拉取源码
2 编译打包
3 根据打包文件的名字区分各个渠道包，版本
4 上传对应ftp目录
5 邮件通知产品运营

实现之后，还是麻烦，因为产品不懂代码，运行shell麻烦，于是flask搭建网站，只要点一下按钮就可以
之后费了功夫加入monkey测试。

每一个环节起始都不是很难，为何以前没人做？完了才发现原来没有人想做出改变，无话可说。

## V2 版本
发现了jenkins自动化工具。原来早已经有轮子了，我还自己搞一遍，真的是。。。。
jenkins主要是配置，流程和shell差不多，还多了很多可选项。
实现了之前所有功能，还可以定时半夜拉代码在模拟器测试，每天早上将日志发给开发查看，简直好用。

## V3版本
android项目编译越来越慢，发现有时候是卡在下载依赖包，为了解决下载依赖包太慢，有时候vpn也不好使，墙太高
最后使用nexus建立公司的代码仓库，所有组内同事配置链接，只要有一个人下载过，其他人直接内网下载，效率直线提升。

## 最后想说的
工具： jenkins，nexus
使用方法：因业务而已，配置都一样，查看官方文档，如果不会看文档这最基本的东西，那就继续重复好了。

没有问题是无法解决的，不要轻易说不。
